<!DOCTYPE html>
<html lang="en-us" class="m-auto light"><head>
  <title>Phat C. Vo</title>

<meta name="theme-color" content="" />
<meta charset="utf-8" />
<meta content="width=device-width, initial-scale=1.0" name="viewport" />
<meta name="description" content="Website title" />
<meta name="author" content="Phat C. Vo" />
<meta name="generator" content="aafu theme by Darshan in Hugo 0.120.3" />

        <link rel="apple-touch-icon" sizes="180x180" href="/logo.png">        <link rel="icon" type="image" sizes="32x32" href="/favicon.ico">        <link rel="icon" type="image" sizes="16x16" href="/favicon.ico">        <link rel="manifest" href="/site.webmanifest">        <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#252627">        <link rel="shortcut icon" href="/favicon.ico">        
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.js"></script>
  <!DOCTYPE html>
<html lang="en">
<head>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>

    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>

    
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "\\[", right: "\\]", display: true },
                { left: "\\begin{align}", right: "\\end{align}", display: true },
                { left: "\\begin{bmatrix}", right: "\\end{bmatrix}", display: true },
            ],
        });
    });
    </script>

    
</head>
<body>
    
</body>
</html>
  <link
    rel="stylesheet"
    href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"
    integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu"
    crossorigin="anonymous"
  />
  <link
    rel="stylesheet"
    href="https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css"
  />
  <link
    rel="stylesheet"
    href="//fonts.googleapis.com/css?family=Didact+Gothic%7CRoboto:400%7CRoboto+Mono"
  />
  <link rel="stylesheet" href="/css/aafu.css" />
  
  
      <link rel="stylesheet" href="/css/aafu_compiled.css" />
  
  
  
  <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "\\[", right: "\\]", display: true },
                { left: "\begin{bmatrix}", right: "\end{bmatrix}", display: true },
            ],
        });
    });
  </script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.10/katex.min.css">
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.10/katex.min.js"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.10/contrib/auto-render.min.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      renderMathInElement(document.body);
    });
  </script>

  <script>
    let html = document.querySelector("html");
    let theme = window.localStorage.getItem("theme");
    if (theme) {
      theme === "dark"
        ? html.classList.add("dark")
        : html.classList.remove("dark");
    } else if (html.classList.contains("dark")) {
      window.localStorage.setItem("theme", "dark");
    } else {
      html.classList.remove("dark");
      window.localStorage.setItem("theme", "light");
    }

    window.onload = () => {
      let themeToggle = document.querySelector(".theme-toggle");
      if (window.localStorage.getItem("theme") === "dark") {
        themeToggle.classList.remove("bi-moon-fill");
        themeToggle.classList.add("bi-brightness-high");
      } else {
        themeToggle.classList.add("bi-moon-fill");
        themeToggle.classList.remove("bi-brightness-high");
      }

      let defaultActivePanel = document.querySelector(".accordion.active");
      if (defaultActivePanel) {
        defaultActivePanel.nextElementSibling.style.maxHeight =
          defaultActivePanel.nextElementSibling.scrollHeight + "px";
      }
    };

    
    window.onresize = () => {
      let defaultActivePanel = document.querySelector(".accordion.active");
      if (defaultActivePanel) {
        defaultActivePanel.nextElementSibling.style.maxHeight =
          defaultActivePanel.nextElementSibling.scrollHeight + "px";
      }
    };
  </script>
  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

</head>
<body class="h-screen p-2 m-auto max-w-4xl flex flex-col">
    <header
  class="nav flex flex-row row p-2 mb-6 w-full border-b border-gray-300 dark:border-gray-700 justify-between"
>
  <div>
    <a class="mr-4 no-underline p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-800" href="https://phatcvo.github.io">Home</a>    
    <a class="mr-4 no-underline p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-800" href="/blog">Blog(EN)</a>
    <a class="mr-4 no-underline p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-800" href="https://phatcvo.blogspot.com/">Blog(VN)</a>
  </div>
  
  <i
    class="fas fa-sun theme-toggle text-blue-500 hover:text-blue-700 dark:text-yellow-300 dark:hover:text-yellow-500 cursor-pointer text-lg mr-9 sm:mr-0"
    onclick="lightDark(this)"
  ></i>
</header>

<script>
  const lightDark = (el) => {
    let html = document.querySelector("html");
    if (html.classList.contains("dark")) {
      html.classList.remove("dark");
      el.classList.add("bi-moon-fill");
      el.classList.remove("bi-brightness-high");
      window.localStorage.setItem("theme", "light");
    } else {
      html.classList.add("dark");
      el.classList.add("bi-brightness-high");
      el.classList.remove("bi-moon-fill");
      window.localStorage.setItem("theme", "dark");
    }
  }; 



</script>




    <main class="grow">
<div class="prose prose-stone dark:prose-invert max-w-none">
<div class="mb-3">
  <h1 class="top-h1" style="font-size: 2.75em">[Book] Clean Code - Chapter 6</h1>
  <p class="mb-1">January 1, 0001</p>
  <p>&mdash;</p>
</div>
<div class="content">
  <h2 id="chÆ°Æ¡ng-6-Ä‘á»‘i-tÆ°á»£ng-vÃ -cáº¥u-trÃºc-dá»¯-liá»‡u">CHÆ¯Æ NG 6: Äá»I TÆ¯á»¢NG VÃ€ Cáº¤U TRÃšC Dá»® LIá»†U</h2>
<p>ChÃºng tÃ´i cÃ³ lÃ½ do khi muá»‘n giá»¯ cÃ¡c biáº¿n lÃ  private. ChÃºng tÃ´i khÃ´ng muá»‘n ai Ä‘Ã³ phá»¥ thuá»™c vÃ o chÃºng. ChÃºng tÃ´i muá»‘n giá»¯ sá»± tá»± do Ä‘á»ƒ thay Ä‘á»•i kiá»ƒu (dá»¯ liá»‡u) hoáº·c thá»±c hiá»‡n cÃ¡c hÃ nh Ä‘á»™ng tÃ¹y biáº¿n. NhÆ°ng sau Ä‘Ã³ thÃ¬ sao? Ráº¥t nhiá»u láº­p trÃ¬nh viÃªn tá»± Ä‘á»™ng thÃªm getter vÃ  setter vÃ o class cá»§a há», cháº³ng khÃ¡c gÃ¬ thay Ä‘á»•i cÃ¡c biáº¿n <code>private</code> thÃ nh <code>public</code>.</p>
<h2 id="trá»«u-tÆ°á»£ng-hÃ³a-dá»¯-liá»‡u">Trá»«u tÆ°á»£ng hÃ³a dá»¯ liá»‡u</h2>
<p>HÃ£y xem xÃ©t sá»± khÃ¡c biá»‡t giá»¯a Listing 6-1 vÃ  Listing 6-2. Cáº£ hai Ä‘á»u Ä‘áº¡i diá»‡n cho dá»¯ liá»‡u cá»§a má»™t Ä‘iá»ƒm trong há»‡ tá»a Ä‘á»™ Descartes. Tuy nhiÃªn, má»™t cÃ¡i thÃ¬ Ä‘á»ƒ lá»™ viá»‡c triá»ƒn khai trong khi cÃ¡i cÃ²n láº¡i thÃ¬ khÃ´ng.</p>
<table>
<thead>
<tr>
<th>Listing 6-1 <strong>Concrete Point</strong></th>
</tr>
</thead>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Point</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">double</span> x;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">double</span> y;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><table>
<thead>
<tr>
<th>Listing 6-2 <strong>Abstract Point</strong></th>
</tr>
</thead>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Point</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">double</span> <span style="color:#a6e22e">getX</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">double</span> <span style="color:#a6e22e">getY</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setCartesian</span>(<span style="color:#66d9ef">double</span> x, <span style="color:#66d9ef">double</span> y);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">double</span> <span style="color:#a6e22e">getR</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">double</span> <span style="color:#a6e22e">getTheta</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setPolar</span>(<span style="color:#66d9ef">double</span> r, <span style="color:#66d9ef">double</span> theta);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>CÃ¡i hay cá»§a Listing 6-2 lÃ  khÃ´ng cÃ³ cÃ¡ch nÃ o báº¡n biáº¿t Ä‘Æ°á»£c viá»‡c triá»ƒn khai interface sáº½ Ä‘Æ°á»£c dÃ¹ng cho hÃ¬nh chá»¯ nháº­t hay cÃ¡c gÃ³c tá»a Ä‘á»™, hoáº·c khÃ´ng gÃ¬ cáº£. <code>Interface</code> rÃµ rÃ ng lÃ  má»™t dáº¡ng cáº¥u trÃºc dá»¯ liá»‡u.</p>
<p>NhÆ°ng nÃ³ khÃ´ng chá»‰ lÃ  má»™t dáº¡ng cáº¥u trÃºc dá»¯ liá»‡u. CÃ¡c phÆ°Æ¡ng thá»©c tuÃ¢n theo má»™t chÃ­nh sÃ¡ch truy cáº­p duy nháº¥t. Báº¡n cÃ³ thá»ƒ Ä‘á»c cÃ¡c tá»a Ä‘á»™ riÃªng láº» má»™t cÃ¡ch Ä‘á»™c láº­p, nhÆ°ng báº¡n pháº£i Ä‘áº·t cÃ¡c tá»a Ä‘á»™ láº¡i vá»›i nhau Ä‘á»ƒ táº¡o nÃªn má»™t hoáº¡t Ä‘á»™ng nguyÃªn tá»­.</p>
<p>Listing 6-1, máº·t khÃ¡c, thá»ƒ hiá»‡n ráº¥t rÃµ rÃ ng cÃ¡c tá»a Ä‘á»™ thuá»™c vá» hÃ¬nh chá»¯ nháº­t vÃ  nÃ³ buá»™c chÃºng ta pháº£i thao tÃ¡c vá»›i cÃ¡c tá»a Ä‘á»™ Ä‘Ã³ má»™t cÃ¡ch Ä‘á»™c láº­p. Äiá»u nÃ y lÃ m lá»™ dá»¯ liá»‡u ngay cáº£ khi cÃ¡c biáº¿n lÃ  <code>private</code> vÃ  chÃºng tÃ´i Ä‘ang sá»­ dá»¥ng cÃ¡c getter/setter.</p>
<p>áº¨n viá»‡c triá»ƒn khai khÃ´ng Ä‘Æ¡n giáº£n lÃ  viá»‡c Ä‘áº·t má»™t biáº¿n vÃ o giá»¯a cÃ¡c hÃ m, Ä‘Ã³ lÃ  váº¥n Ä‘á» trá»«u tÆ°á»£ng hÃ³a. Má»™t class khÃ´ng chá»‰ Ä‘Æ¡n giáº£n lÃ  Ä‘áº©y cÃ¡c biáº¿n cá»§a nÃ³ thÃ´ng qua cÃ¡c getter/setter. Thay vÃ o Ä‘Ã³ nÃ³ cung cáº¥p cÃ¡c <code>abstract interface</code> cho phÃ©p ngÆ°á»i dÃ¹ng thao tÃ¡c vá»›i báº£n cháº¥t cá»§a dá»¯ liá»‡u mÃ  khÃ´ng cáº§n quan tÃ¢m Ä‘áº¿n cÃ¡ch chÃºng hoáº¡t Ä‘á»™ng.</p>
<p>HÃ£y xem xÃ©t Listing 6-3 vÃ  Listing 6-4. CÃ¡i Ä‘áº§u tiÃªn sá»­ dá»¥ng cÃ¡c thuáº­t ngá»¯ cá»¥ thá»ƒ Ä‘á»ƒ chá»‰ ra má»©c nhiÃªn liá»‡u cá»§a má»™t phÆ°Æ¡ng tiá»‡n (vehicle), trong khi cÃ¡i thá»© hai lÃ m Ä‘iá»u tÆ°Æ¡ng tá»± nhÆ°ng vá»›i tá»‰ lá»‡ pháº§n trÄƒm. Trong trÆ°á»ng há»£p cá»¥ thá»ƒ, báº¡n cÃ³ thá»ƒ cháº¯c cháº¯n ráº±ng Ä‘Ã¢y chá»‰ lÃ  nhá»¯ng truy xuáº¥t Ä‘áº¿n cÃ¡c biáº¿n. Trong trÆ°á»ng há»£p trá»«u tÆ°á»£ng, báº¡n hoÃ n toÃ n khÃ´ng cÃ³ manh má»‘i nÃ o vá» hÃ¬nh thá»©c cá»§a dá»¯ liá»‡u.</p>
<table>
<thead>
<tr>
<th>Listing 6-3 <strong>Concrete Vehicle</strong></th>
</tr>
</thead>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Vehicle</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">double</span> <span style="color:#a6e22e">getFuelTankCapacityInGallons</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">double</span> <span style="color:#a6e22e">getGallonsOfGasoline</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><table>
<thead>
<tr>
<th>Listing 6-4 <strong>Abstract Vehicle</strong></th>
</tr>
</thead>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Vehicle</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">double</span> <span style="color:#a6e22e">getPercentFuelRemaining</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Trong hai trÆ°á»ng há»£p trÃªn, tÃ¹y chá»n thá»© hai lÃ  thÃ­ch há»£p hÆ¡n. ChÃºng tÃ´i khÃ´ng muá»‘n tiáº¿t lá»™ chi tiáº¿t vá» dá»¯ liá»‡u, thay vÃ o Ä‘Ã³ chÃºng tÃ´i muá»‘n giá»¯ dá»¯ liá»‡u cá»§a chÃºng tÃ´i á»Ÿ cÃ¡c dáº¡ng trá»«u tÆ°á»£ng. Äiá»u nÃ y khÃ´ng chá»‰ Ä‘Æ¡n thuáº§n Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng cÃ¡ch sá»­ dá»¥ng cÃ¡c <strong>interface</strong> vÃ /hoáº·c getter vÃ  setter. Sá»­ dá»¥ng getter/setter lÃ  tÃ¹y chá»n tá»“i tá»‡ nháº¥t mÃ  tÃ´i sáº½ thá»±c hiá»‡n.</p>
<h2 id="cáº¥u-trÃºc-dá»¯-liá»‡u-vÃ -Ä‘á»‘i-tÆ°á»£ng">Cáº¥u trÃºc dá»¯ liá»‡u vÃ  Ä‘á»‘i tÆ°á»£ng</h2>
<p>Hai vÃ­ dá»¥ dÆ°á»›i Ä‘Ã¢y cho tháº¥y sá»± khÃ¡c biá»‡t giá»¯a cÃ¡c Ä‘á»‘i tÆ°á»£ng vÃ  dá»¯ liá»‡u cÃ³ cáº¥u trÃºc. CÃ¡c Ä‘á»‘i tÆ°á»£ng áº©n dá»¯ liá»‡u cá»§a chÃºng bÃªn dÆ°á»›i viá»‡c trá»«u tÆ°á»£ng hÃ³a vÃ  Ä‘Æ°a ra cÃ¡c hÃ m dá»±a trÃªn dá»¯ liá»‡u Ä‘Ã³. Dá»¯ liá»‡u cÃ³ cáº¥u trÃºc phÆ¡i bÃ y dá»¯ liá»‡u cá»§a chÃºng vÃ  khÃ´ng cÃ³ cÃ¡c hÃ m cÃ³ nhiá»u Ã½ nghÄ©a. Quay láº¡i vÃ  Ä‘á»c nÃ³ má»™t láº§n ná»¯a. LÆ°u Ã½ báº£n cháº¥t cá»§a hai Ä‘á»‹nh nghÄ©a. ChÃºng thá»±c sá»± Ä‘á»‘i láº­p nhau. Sá»± khÃ¡c biá»‡t nÃ y cÃ³ váº» khÃ´ng Ä‘Ã¡ng ká»ƒ, nhÆ°ng nÃ³ cÃ³ áº£nh hÆ°á»Ÿng sÃ¢u Ä‘áº¿n há»‡ thá»‘ng.</p>
<p>VÃ­ dá»¥, xem xÃ©t vÃ­ dá»¥ vá» cÃ¡c class liÃªn quan Ä‘áº¿n hÃ¬nh há»c trong Listing 6-5. Class Geometry hoáº¡t Ä‘á»™ng vá»›i dá»¯ liá»‡u cá»§a ba class khÃ¡c. (CÃ¡c class khÃ¡c nÃ y) lÃ  cÃ¡c <em>cáº¥u trÃºc dá»¯ liá»‡u</em> Ä‘Æ¡n giáº£n mÃ  khÃ´ng cÃ³ báº¥t ká»³ phÆ°Æ¡ng thá»©c nÃ o. CÃ¡c hÃ nh Ä‘á»™ng Ä‘á»u thuá»™c vá» class Geometry.</p>
<table>
<thead>
<tr>
<th>Listing 6-5 <strong>Procedural Shape</strong></th>
</tr>
</thead>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Square</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Point topLeft;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">double</span> side;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Rectangle</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Point topLeft;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">double</span> height;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">double</span> width;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Circle</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Point center;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">double</span> radius;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Geometry</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">double</span> PI <span style="color:#f92672">=</span> 3.<span style="color:#a6e22e">141592653589793</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">double</span> <span style="color:#a6e22e">area</span>(Object shape) <span style="color:#66d9ef">throws</span> NoSuchShapeException
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (shape <span style="color:#66d9ef">instanceof</span> Square) {
</span></span><span style="display:flex;"><span>            Square s <span style="color:#f92672">=</span> (Square)shape;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> s.<span style="color:#a6e22e">side</span> <span style="color:#f92672">*</span> s.<span style="color:#a6e22e">side</span>;
</span></span><span style="display:flex;"><span>        }<span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (shape <span style="color:#66d9ef">instanceof</span> Rectangle) {
</span></span><span style="display:flex;"><span>            Rectangle r <span style="color:#f92672">=</span> (Rectangle)shape;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> r.<span style="color:#a6e22e">height</span> <span style="color:#f92672">*</span> r.<span style="color:#a6e22e">width</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (shape <span style="color:#66d9ef">instanceof</span> Circle) {
</span></span><span style="display:flex;"><span>            Circle c <span style="color:#f92672">=</span> (Circle)shape;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> PI <span style="color:#f92672">*</span> c.<span style="color:#a6e22e">radius</span> <span style="color:#f92672">*</span> c.<span style="color:#a6e22e">radius</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> NoSuchShapeException();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>CÃ¡c láº­p trÃ¬nh viÃªn hÆ°á»›ng Ä‘á»‘i tÆ°á»£ng cÃ³ thá»ƒ khÃ´ng Ä‘á»“ng Ã½ vá»›i Ä‘iá»u nÃ y vÃ  cho ráº±ng Ä‘Ã³ lÃ  má»™t phÆ°Æ¡ng phÃ¡p cá»§a há» - vÃ  chÃºng Ä‘Ãºng. NhÆ°ng ngÆ°á»i khÃ¡c cÃ³ thá»ƒ nhÃ¬n vÃ o vÃ  chÃª cÆ°á»i vÃ¬ chÃºng cÃ³ kháº£ nÄƒng khÃ´ng Ä‘Æ°á»£c quan tÃ¢m vÃ  báº£o trÃ¬. Chuyá»‡n gÃ¬ xáº£y ra náº¿u tÃ´i thÃªm vÃ o class Geometry má»™t hÃ m tÃ­nh chu vi? KhÃ´ng sao cáº£, cÃ¡c class bÃªn trÃªn nÃ³ sáº½ khÃ´ng bá»‹ áº£nh hÆ°á»Ÿng. NhÆ°ng náº¿u tÃ´i thÃªm vÃ o má»™t class má»›i liÃªn quan Ä‘áº¿n hÃ¬nh há»c (Triangle cháº³ng háº¡n), tÃ´i pháº£i thay Ä‘á»•i cÃ¡c hÃ m trong class Geometry Ä‘á»ƒ phÃ¹ há»£p vá»›i nÃ³. Äá»c láº¡i nÃ³ láº§n ná»¯a. LÆ°u Ã½ ráº±ng chÃºng tháº­t sá»± Ä‘á»‘i láº­p nhau.</p>
<p>BÃ¢y giá» hÃ£y xem giáº£i phÃ¡p á»Ÿ Listing 6-6. PhÆ°Æ¡ng thá»©c <code>area()</code> á»Ÿ Ä‘Ã¢y lÃ  Ä‘a hÃ¬nh, khÃ´ng cáº§n class Geometry, vÃ¬ váº­y náº¿u tÃ´i thÃªm má»™t class hÃ¬nh há»c má»›i, sáº½ khÃ´ng cÃ³ hÃ m nÃ o cáº§n thay Ä‘á»•i. NhÆ°ng náº¿u tÃ´i thÃªm má»™t hÃ m má»›i, táº¥t cáº£ cÃ¡c class káº¿ thá»«a bÃªn dÆ°á»›i Ä‘á»u cáº§n pháº£i thay Ä‘á»•i!</p>
<table>
<thead>
<tr>
<th>Listing 6-6 <strong>Polymorphic Shapes</strong></th>
</tr>
</thead>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Square</span> <span style="color:#66d9ef">implements</span> Shape {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> Point topLeft;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">double</span> side;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">double</span> <span style="color:#a6e22e">area</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> side<span style="color:#f92672">*</span>side;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Rectangle</span> <span style="color:#66d9ef">implements</span> Shape {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> Point topLeft;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">double</span> height;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">double</span> width;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">double</span> <span style="color:#a6e22e">area</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> height <span style="color:#f92672">*</span> width;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Circle</span> <span style="color:#66d9ef">implements</span> Shape {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> Point center;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">double</span> radius;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">double</span> PI <span style="color:#f92672">=</span> 3.<span style="color:#a6e22e">141592653589793</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">double</span> <span style="color:#a6e22e">area</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> PI <span style="color:#f92672">*</span> radius <span style="color:#f92672">*</span> radius;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Má»™t láº§n ná»¯a, chÃºng ta tháº¥y sá»± Ä‘á»‘i láº­p giá»¯a hai váº¥n Ä‘á» nÃ y. Äiá»u nÃ y chá»‰ ra sá»± khÃ¡c biá»‡t cÆ¡ báº£n giá»¯a cÃ¡c Ä‘á»‘i tÆ°á»£ng vÃ  cáº¥u trÃºc dá»¯ liá»‡u:</p>
<blockquote>
<p><em>CÃ¡c dÃ²ng code sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p cáº¥u trÃºc dá»¯ liá»‡u giÃºp dá»… dÃ ng thÃªm cÃ¡c hÃ m má»›i mÃ  khÃ´ng cáº§n pháº£i thay Ä‘á»•i cáº¥u trÃºc cá»§a dá»¯ liá»‡u hiá»‡n táº¡i. Máº·t khÃ¡c, code theo phÆ°Æ¡ng phÃ¡p hÆ°á»›ng Ä‘á»‘i tÆ°á»£ng giÃºp dá»… dÃ ng thÃªm cÃ¡c class má»›i mÃ  khÃ´ng thay Ä‘á»•i cÃ¡c hÃ m Ä‘Ã£ viáº¿t.</em></p>
</blockquote>
<p>Báº¡n cÅ©ng cÃ³ thá»ƒ hiá»ƒu nÃ³ nhÆ° sau:</p>
<blockquote>
<p><em>Code theo cáº¥u trÃºc dá»¯ liá»‡u lÃ m báº¡n khÃ³ thÃªm dá»¯ liá»‡u má»›i vÃ¬ pháº£i thay Ä‘á»•i toÃ n bá»™ hÃ m. Code theo hÆ°á»›ng Ä‘á»‘i tÆ°á»£ng lÃ m báº¡n khÃ³ thÃªm hÃ m vÃ¬ pháº£i thay Ä‘á»•i táº¥t cáº£ cÃ¡c class chá»‹u áº£nh hÆ°á»Ÿng.</em></p>
</blockquote>
<p>Váº­y lÃ , Æ°u Ä‘iá»ƒm cá»§a phÆ°Æ¡ng phÃ¡p nÃ y láº¡i lÃ  nhÆ°á»£c Ä‘iá»ƒm cá»§a phÆ°Æ¡ng phÃ¡p kia, vÃ  ngÆ°á»£c láº¡i.</p>
<p>Trong báº¥t ká»³ há»‡ thá»‘ng nÃ o, sáº½ cÃ³ lÃºc chÃºng ta muá»‘n bá»• sung cÃ¡c kiá»ƒu dá»¯ liá»‡u má»›i thay vÃ¬ cÃ¡c hÃ m má»›i. Trong trÆ°á»ng há»£p nÃ y phÆ°Æ¡ng phÃ¡p hÆ°á»›ng Ä‘á»‘i tÆ°á»£ng sáº½ phÃ¹ há»£p hÆ¡n. NhÆ°ng cÅ©ng cÃ³ lÃºc chÃºng ta muá»‘n thÃªm hÃ m má»›i thay vÃ¬ thÃªm dá»¯ liá»‡u. Trong trÆ°á»ng há»£p nÃ y, cáº¥u trÃºc dá»¯ liá»‡u nÃªn Ä‘Æ°á»£c Æ°u tiÃªn hÆ¡n.</p>
<p>CÃ¡c láº­p trÃ¬nh viÃªn giÃ u kinh nghiá»‡m biáº¿t ráº±ng Ã½ tÆ°á»Ÿng <em>Ä‘á»‘i tÆ°á»£ng hÃ³a</em> má»i thá»© lÃ  chuyá»‡n hoang Ä‘Æ°á»ng. ÄÃ´i khi báº¡n cáº§n cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u Ä‘Æ¡n giáº£n Ä‘á»ƒ phÃ¡t triá»ƒn cÃ¡c hÃ m trÃªn chÃºng.</p>
<h2 id="the-law-of-demeter">The Law of Demeter</h2>
<p>CÃ³ má»™t ká»¹ thuáº­t ná»•i tiáº¿ng Ä‘Æ°á»£c gá»i lÃ  <em>Law of Demeter</em>, nÃ³i ráº±ng má»™t module khÃ´ng nÃªn biáº¿t vá» thÃ nh pháº§n bÃªn trong cá»§a má»™t Ä‘á»‘i tÆ°á»£ng mÃ  nÃ³ sá»­ dá»¥ng. NhÆ° chÃºng ta Ä‘Ã£ tháº¥y trong cÃ¡c pháº§n trÆ°á»›c, cÃ¡c Ä‘á»‘i tÆ°á»£ng áº©n dá»¯ liá»‡u cá»§a chÃºng vÃ  Ä‘Æ°a ra nhá»¯ng phÆ°Æ¡ng thá»©c. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  cÃ¡c Ä‘á»‘i tÆ°á»£ng khÃ´ng nÃªn phÆ¡i bÃ y cáº¥u trÃºc cá»§a chÃºng thÃ´ng qua cÃ¡c getter/setter vÃ¬ viá»‡c nÃ y lÃ m lá»™ cáº¥u trÃºc bÃªn trong nÃ³, Ä‘iá»u chÃºng ta cáº§n lÃ m lÃ  áº©n chÃºng Ä‘i.</p>
<p>Cá»¥ thá»ƒ, Law of Demeter nÃ³i ráº±ng má»™t phÆ°Æ¡ng thá»©c <em>f</em> cá»§a class <em>C</em> chá»‰ nÃªn gá»i nhá»¯ng phÆ°Æ¡ng thá»©c sau:</p>
<ul>
<li><em>C</em></li>
<li>Má»™t Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c táº¡o bá»Ÿi <em>f</em></li>
<li>Má»™t Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c truyá»n vÃ o dÆ°á»›i dáº¡ng Ä‘á»‘i sá»‘ cá»§a <em>f</em></li>
<li>Má»™t Ä‘á»‘i tÆ°á»£ng chá»©a má»™t biáº¿n instance cá»§a <em>C</em></li>
</ul>
<p>HÃ m khÃ´ng nÃªn gá»i cÃ¡c phÆ°Æ¡ng thá»©c khÃ¡c cá»§a phÆ°Æ¡ng thá»©c khÃ¡c. NÃ³i cÃ¡ch khÃ¡c, chá»‰ lÃ m viá»‡c vá»›i báº¡n bÃ¨, khÃ´ng lÃ m viá»‡c vá»›i ngÆ°á»i láº¡.</p>
<p>Äoáº¡n code sau dÆ°á»ng nhÆ° vi pháº¡m Law of Demeter vÃ¬ nÃ³ gá»i hÃ m <code>getScratchDir()</code> báº±ng giÃ¡ trá»‹ tráº£ vá» cá»§a <code>getOptions()</code>, vÃ  sau Ä‘Ã³ gá»i <code>getAbsolutePath()</code> báº±ng giÃ¡ trá»‹ tráº£ vá» cá»§a <code>getScratchDir()</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">final</span> String outputDir <span style="color:#f92672">=</span> ctxt.<span style="color:#a6e22e">getOptions</span>().<span style="color:#a6e22e">getScratchDir</span>().<span style="color:#a6e22e">getAbsolutePath</span>();
</span></span></code></pre></div><h3 id="train-wrecks">Train Wrecks</h3>
<p>Dáº¡ng code nÃ y thÆ°á»ng Ä‘Æ°á»£c gá»i lÃ  <em>train wreck</em> (Ä‘oÃ n tÃ u pháº¿ liá»‡u ğŸ˜„) vÃ¬ nÃ³ trÃ´ng giá»‘ng nhÆ° má»™t loáº¡t cÃ¡c toa tÃ u Ä‘Æ°á»£c ghÃ©p láº¡i vá»›i nhau. CÃ¡c chuá»—i lá»i gá»i hÃ m nhÆ° tháº¿ nÃ y Ä‘Æ°á»£c coi lÃ  biá»ƒu hiá»‡n cá»§a sá»± cáº©u lÆ°Æ¡ng vÃ  nÃªn trÃ¡nh chÃºng. CÃ¡ch tá»‘t nháº¥t lÃ  nÃªn tÃ¡ch chÃºng ra nhÆ° sau:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Options opts <span style="color:#f92672">=</span> ctxt.<span style="color:#a6e22e">getOptions</span>();
</span></span><span style="display:flex;"><span>File scratchDir <span style="color:#f92672">=</span> opts.<span style="color:#a6e22e">getScratchDir</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">final</span> String outputDir <span style="color:#f92672">=</span> scratchDir.<span style="color:#a6e22e">getAbsolutePath</span>();
</span></span></code></pre></div><p><img src="../img/chap06_img01.png" alt="chap06_img01.png" title=""></p>
<p>Äoáº¡n code trÃªn cÃ³ vi pháº¡m Law of Demeter (LoD)? Cháº¯c cháº¯n module chá»©a chÃºng biáº¿t ráº±ng Ä‘á»‘i tÆ°á»£ng <code>ctxt</code> chá»©a <code>Options</code>, cÃ³ <code>AbsolutePath</code> (Ä‘Æ°á»ng dáº«n tuyá»‡t Ä‘á»‘i). QuÃ¡ nhiá»u thÃ´ng tin bá»‹ lá»™ ra.[&hellip;]</p>
<p>NhÆ°ng viá»‡c nÃ³ cÃ³ vi pháº¡m LoD cÃ²n phá»¥ thuá»™c vÃ o <code>ctxt</code>, <code>Options</code> vÃ  <code>ScratchDir</code> lÃ  cÃ¡c Ä‘á»‘i tÆ°á»£ng hay chá»‰ Ä‘Æ¡n thuáº§n lÃ  cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u. Náº¿u chÃºng lÃ  Ä‘á»‘i tÆ°á»£ng, thÃ¬ cáº¥u trÃºc bÃªn trong chÃºng nÃªn Ä‘Æ°á»£c áº©n Ä‘i chá»© khÃ´ng nÃªn Ä‘á»ƒ lá»™ thiÃªn nhÆ° tháº¿, vÃ  viá»‡c Ä‘á»ƒ lá»™ thÃ´ng tin vá» dá»¯ liá»‡u bÃªn trong chÃºng rÃµ rÃ ng lÃ  vi pháº¡m LoD. Máº·t khÃ¡c, náº¿u <code>ctxt</code>, <code>Options</code> vÃ  <code>ScratchDir</code> chá»‰ lÃ  cÃ¡c cáº¥u trÃºc khÃ´ng cÃ³ hÃ m xá»­ lÃ½, thÃ¬ viá»‡c lá»™ dá»¯ liá»‡u bÃªn trong chÃºng lÃ  hiá»ƒn nhiÃªn vÃ  LoD khÃ´ng Ä‘Æ°á»£c Ã¡p dá»¥ng trong trÆ°á»ng há»£p nÃ y.</p>
<p>Viá»‡c sá»­ dá»¥ng cÃ¡c hÃ m truy cáº­p (getter/setter) lÃ m váº¥n Ä‘á» trá»Ÿ nÃªn máº­p má». Náº¿u code Ä‘Æ°á»£c viáº¿t nhÆ° sau thÃ¬ cÃ³ láº½ chÃºng ta sáº½ thÃ´i cháº¥t váº¥n nhau vá» LoD:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">final</span> String outputDir <span style="color:#f92672">=</span> ctxt.<span style="color:#a6e22e">options</span>.<span style="color:#a6e22e">scratchDir</span>.<span style="color:#a6e22e">absolutePath</span>;
</span></span></code></pre></div><p>Váº¥n Ä‘á» nÃ y sáº½ Ã­t gÃ¢y nháº§m láº«n hÆ¡n náº¿u cÃ¡c cáº¥u trÃºc Ä‘Æ¡n giáº£n chá»‰ cÃ³ biáº¿n public vÃ  khÃ´ng cÃ³ phÆ°Æ¡ng thá»©c, trong khi cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ³ cÃ¡c biáº¿n private vÃ  cÃ¡c hÃ m public. Tuy nhiÃªn, má»™t vÃ i framework yÃªu cáº§u ráº±ng ngay cáº£ cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u Ä‘Æ¡n giáº£n cÅ©ng cáº§n pháº£i cÃ³ cÃ¡c hÃ m truy cáº­p.</p>
<h3 id="con-lai">Con lai</h3>
<p>Sá»± nháº§m láº«n nÃ y Ä‘Ã´i khi táº¡o nÃªn cÃ¡c Ä‘á»©a con lai, mang ná»­a dÃ²ng mÃ¡u Ä‘á»‘i tÆ°á»£ng vÃ  má»™t ná»­a cÃ²n láº¡i lÃ  cáº¥u trÃºc. ChÃºng cÃ³ cÃ¡c hÃ m lÃ m nhá»¯ng viá»‡c quan trá»ng, chÃºng cÅ©ng cÃ³ cÃ¡c biáº¿n public hoáº·c cÃ¡c hÃ m truy cáº­p public,&hellip;vá»›i má»¥c Ä‘Ã­ch cuá»‘i cÃ¹ng lÃ  hÃ´ biáº¿n cÃ¡c biáº¿n private thÃ nh public, dá»¥ dá»— cÃ¡c hÃ m bÃªn ngoÃ i sá»­ dá»¥ng cÃ¡c biáº¿n private (thÃ´ng qua getter/setter) nhÆ° má»™t cáº¥u trÃºc Ä‘Æ¡n giáº£n.</p>
<p>Nhá»¯ng Ä‘á»©a con lai nÃ y khiáº¿n cho viá»‡c thÃªm má»›i hÃ m trá»Ÿ nÃªn khÃ³ khÄƒn, vÃ  viá»‡c thÃªm thuá»™c tÃ­nh má»›i cÅ©ng khÃ³ khÄƒn ná»‘t ğŸ™‚. ChÃºng lÃ  thá»© tá»“i tá»‡ nháº¥t mÃ  báº¡n sáº½ táº¡o ra, váº­y nÃªn Ä‘á»«ng táº¡o ra chÃºng. ChÃºng lÃ  dáº¥u hiá»‡u cho tháº¥y má»™t thiáº¿t káº¿ nhÆ° sh!t cá»§a láº­p trÃ¬nh viÃªn nÃ o Ä‘áº¥y táº¡o ra mÃ  khÃ´ng cháº¯c thá»© anh áº¥y Ä‘ang táº¡o ra lÃ  gÃ¬ â€“ má»™t cáº¥u trÃºc Ä‘Æ¡n giáº£n vá»›i nhiá»u dá»¯ liá»‡u hay má»™t Ä‘á»‘i tÆ°á»£ng vá»›i nhiá»u phÆ°Æ¡ng thá»©c.</p>
<h3 id="áº©n-cáº¥u-trÃºc">áº¨n cáº¥u trÃºc</h3>
<p>Äiá»u gÃ¬ xáº£y ra náº¿u <code>ctxt</code>, <code>Options</code> vÃ  <code>ScratchDir</code> lÃ  cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ³ hÃ nh vi thá»±c sá»±? Náº¿u váº­y, chÃºng pháº£i giáº¥u cáº¥u trÃºc bÃªn trong Ä‘i, vÃ  chÃºng ta khÃ´ng thá»ƒ lÃ m gÃ¬ vá»›i chÃºng. Váº­y thÃ¬ chÃºng ta láº¥y Ä‘Æ°á»ng dáº«n tuyá»‡t Ä‘á»‘i (AbsolutePath) cá»§a thÆ° má»¥c báº±ng cÃ¡ch nÃ o?</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>ctxt.<span style="color:#a6e22e">getAbsolutePathOfScratchDirectoryOption</span>();
</span></span></code></pre></div><p>hay</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>ctx.<span style="color:#a6e22e">getScratchDirectoryOption</span>().<span style="color:#a6e22e">getAbsolutePath</span>();
</span></span></code></pre></div><p>Lá»±a chá»n Ä‘áº§u tiÃªn cÃ³ thá»ƒ phÃ¡t sinh ra hÃ ng loáº¡t phÆ°Æ¡ng thá»©c chá»“ng chÃ©o nhau bÃªn trong Ä‘á»‘i tÆ°á»£ng <code>ctxt</code>. Lá»±a chá»n thá»© hai cho ráº±ng <code>getScratchDirectoryOption()</code> tráº£ vá» má»™t cáº¥u trÃºc, khÃ´ng pháº£i má»™t Ä‘á»‘i tÆ°á»£ng. KhÃ´ng cÃ³ lá»±a chá»n nÃ o Ä‘á»§ tá»‘t.</p>
<p>Náº¿u <code>ctxt</code> lÃ  má»™t Ä‘á»‘i tÆ°á»£ng, chÃºng ta nÃªn báº£o nÃ³ lÃ m gÃ¬ Ä‘Ã³, khÃ´ng nÃªn há»i nÃ³ vá» cáº¥u trÃºc bÃªn trong nÃ³. Váº­y táº¡i sao chÃºng ta muá»‘n Ä‘Æ°á»ng dáº«n tuyá»‡t Ä‘á»‘i cá»§a thÆ° má»¥c? ChÃºng ta sáº½ lÃ m gÃ¬ vá»›i nÃ³? Xem xÃ©t Ä‘oáº¡n code nÃ y (láº¥y tá»« vÃ i dÃ²ng xa hÆ¡n bÃªn dÆ°á»›i) trong cÃ¹ng má»™t module:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>String outFile <span style="color:#f92672">=</span> outputDir <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/&#34;</span> <span style="color:#f92672">+</span> className.<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">&#39;.&#39;</span>, <span style="color:#e6db74">&#39;/&#39;</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.class&#34;</span>;
</span></span><span style="display:flex;"><span>FileOutputStream fout <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileOutputStream(outFile);
</span></span><span style="display:flex;"><span>BufferedOutputStream bos <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BufferedOutputStream(fout);
</span></span></code></pre></div><p>CÃ¡c chi tiáº¿t khÃ¡c nhau táº¡o nÃªn má»™t chÃºt ráº¯c rá»‘i á»Ÿ Ä‘Ã¢y. Dáº¥u cháº¥m, dáº¥u gáº¡ch chÃ©o, pháº§n má»Ÿ rá»™ng cá»§a file, [&hellip;]. Bá» qua Ä‘iá»u Ä‘Ã³, chÃºng tÃ´i tháº¥y ráº±ng má»¥c Ä‘Ã­ch cá»§a viá»‡c láº¥y Ä‘Æ°á»ng dáº«n tuyá»‡t Ä‘á»‘i lÃ  Ä‘á»ƒ táº¡o má»™t tá»‡p vá»›i tÃªn cá»¥ thá»ƒ.</p>
<p>Váº­y thÃ¬ Ä‘iá»u gÃ¬ sáº½ xáº£y ra náº¿u chÃºng tÃ´i báº£o Ä‘á»‘i tÆ°á»£ng ctxt thá»±c hiá»‡n viá»‡c nÃ y?</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>BufferedOutputStream bos <span style="color:#f92672">=</span> ctxt.<span style="color:#a6e22e">createScratchFileStream</span>(classFileName);
</span></span></code></pre></div><p>KhÃ¡ há»£p lÃ½! Äiá»u nÃ y cho phÃ©p <code>ctxt</code> áº©n ná»™i dung bÃªn trong nÃ³ vÃ  ngÄƒn hÃ m hiá»‡n táº¡i vi pháº¡m LoD báº±ng cÃ¡ch Ä‘iá»u hÆ°á»›ng qua cÃ¡c Ä‘á»‘i tÆ°á»£ng mÃ  module khÃ´ng biáº¿t.</p>
<h2 id="data-transfer-objects">Data Transfer Objects</h2>
<p>Dáº¡ng thuáº§n tÃºy cá»§a cáº¥u trÃºc dá»¯ liá»‡u lÃ  má»™t class cÃ³ cÃ¡c biáº¿n public vÃ  khÃ´ng cÃ³ hÃ m. Dáº¡ng nÃ y Ä‘Ã´i khi Ä‘Æ°á»£c gá»i lÃ  má»™t Ä‘á»‘i tÆ°á»£ng truyá»n dá»¯ liá»‡u (Data transfer object), hoáº·c DTO. CÃ¡c DTO lÃ  cáº¥u trÃºc ráº¥t há»¯u Ã­ch, Ä‘áº·c biá»‡t lÃ  khi giao tiáº¿p vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u hoáº·c chuyá»ƒn Ä‘á»•i thÃ´ng Ä‘iá»‡p tá»« cÃ¡c socket, v.v. ChÃºng thÆ°á»ng lÃ  bÆ°á»›c Ä‘áº§u tiÃªn trong quÃ¡ trÃ¬nh chuyá»ƒn Ä‘á»•i dá»¯ liá»‡u tá»« cÆ¡ sá»Ÿ dá»¯ liá»‡u thÃ nh cÃ¡c Ä‘á»‘i tÆ°á»£ng cá»§a chÆ°Æ¡ng trÃ¬nh.</p>
<p>Má»™t sá»‘ phá»• biáº¿n hÆ¡n lÃ  chuáº©n &ldquo;bean&rdquo; Ä‘Æ°á»£c hiá»ƒn thá»‹ trong Listing 6-7. Bean cÃ³ cÃ¡c biáº¿n riÃªng Ä‘Æ°á»£c thao tÃ¡c bá»Ÿi getter vÃ  setter. Viá»‡c &ldquo;xÃ©m&rdquo; bao Ä‘Ã³ng dÆ°á»ng nhÆ° lÃ m cho nhá»¯ng ngÆ°á»i theo chá»§ nghÄ©a hÆ°á»›ng Ä‘á»‘i tÆ°á»£ng cáº£m tháº¥y Ä‘á»¡ khÃ³ chá»‹u hÆ¡n, nhÆ°ng khÃ´ng mang láº¡i lá»£i Ã­ch nÃ o Ä‘Ã¡ng ká»ƒ.</p>
<table>
<thead>
<tr>
<th>Listing 6-7 <strong>address.java</strong></th>
</tr>
</thead>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Address</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> String street;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> String streetExtra;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> String city;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> String state;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> String zip;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">Address</span>(String street, String streetExtra,
</span></span><span style="display:flex;"><span>                    String city, String state, String zip) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">street</span> <span style="color:#f92672">=</span> street;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">streetExtra</span> <span style="color:#f92672">=</span> streetExtra;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">city</span> <span style="color:#f92672">=</span> city;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">state</span> <span style="color:#f92672">=</span> state;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">zip</span> <span style="color:#f92672">=</span> zip;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getStreet</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> street;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getStreetExtra</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> streetExtra;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getCity</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> city;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getState</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> state;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getZip</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> zip;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="active-records">Active Records</h3>
<p>Active Record lÃ  cÃ¡c hÃ¬nh thá»©c DTO Ä‘áº·c biá»‡t. ChÃºng lÃ  cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u vá»›i cÃ¡c biáº¿n public, Ä‘Ã´i khi cÃ³ cÃ¡c phÆ°Æ¡ng thá»©c nhÆ° <code>Save</code> vÃ  <code>Find</code>. ThÃ´ng thÆ°á»ng cÃ¡c Active Record lÃ  dá»¯ liá»‡u Ä‘Æ°á»£c gá»­i trá»±c tiáº¿p tá»« cÃ¡c báº£ng trong cÆ¡ sá»Ÿ dá»¯ liá»‡u hoáº·c cÃ¡c nguá»“n dá»¯ liá»‡u khÃ¡c.</p>
<p>Tháº­t khÃ´ng may, chÃºng ta thÆ°á»ng tháº¥y cÃ¡c nhÃ  phÃ¡t triá»ƒn Ä‘á»‘i xá»­ vá»›i cáº¥u trÃºc nÃ y nhÆ° thá»ƒ chÃºng lÃ  Ä‘á»‘i tÆ°á»£ng báº±ng cÃ¡ch Ä‘áº·t cÃ¡c phÆ°Æ¡ng thá»©c nghiá»‡p vá»¥ vÃ o chÃºng. Äiá»u nÃ y tháº­t nguy hiá»ƒm vÃ¬ nÃ³ táº¡o ra con quÃ¡i váº­t mang tÃªn con lai nhÆ° Ä‘Ã£ Ä‘á» cáº­p bÃªn trÃªn.</p>
<p>Giáº£i phÃ¡p, táº¥t nhiÃªn lÃ  coi cÃ¡c Active Record lÃ  má»™t cáº¥u trÃºc, Ä‘á»“ng thá»i táº¡o cÃ¡c Ä‘á»‘i tÆ°á»£ng riÃªng biá»‡t chá»©a cÃ¡c phÆ°Æ¡ng thá»©c nghiá»‡p vá»¥ vÃ  áº©n dá»¯ liá»‡u cá»§a chÃºng Ä‘i.</p>
<h2 id="káº¿t-luáº­n">Káº¿t luáº­n</h2>
<p>Äá»‘i tÆ°á»£ng hiá»ƒn thá»‹ ra cÃ¡c hÃ nh Ä‘á»™ng vÃ  áº©n dá»¯ liá»‡u, Ä‘iá»u nÃ y giÃºp dá»… dÃ ng thÃªm cÃ¡c loáº¡i Ä‘á»‘i tÆ°á»£ng má»›i mÃ  khÃ´ng thay Ä‘á»•i cÃ¡c hÃ nh vi hiá»‡n cÃ³. NhÆ°ng nÃ³ cÅ©ng lÃ m cho viá»‡c thÃªm cÃ¡c phÆ°Æ¡ng thá»©c má»›i vÃ o Ä‘á»‘i tÆ°á»£ng hiá»‡n cÃ³ trá»Ÿ nÃªn khÃ³ khÄƒn. Cáº¥u trÃºc dá»¯ liá»‡u phÆ¡i bÃ y dá»¯ liá»‡u vÃ  khÃ´ng cÃ³ nhiá»u phÆ°Æ¡ng thá»©c, Ä‘iá»u nÃ y giÃºp dá»… dÃ ng thÃªm cÃ¡c phÆ°Æ¡ng thá»©c má»›i vÃ o cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u hiá»‡n cÃ³ nhÆ°ng láº¡i lÃ m cho viá»‡c thÃªm cáº¥u trÃºc má»›i vÃ o cÃ¡c hÃ m hiá»‡n cÃ³ trá»Ÿ nÃªn khÃ³ khÄƒn.</p>
<p>Trong báº¥t ká»³ há»‡ thá»‘ng nÃ o, Ä‘Ã´i khi chÃºng tÃ´i sáº½ muá»‘n viá»‡c thay Ä‘á»•i dá»¯ liá»‡u trá»Ÿ nÃªn linh hoáº¡t, vÃ¬ váº­y chÃºng tÃ´i chá»n Ä‘á»‘i tÆ°á»£ng cho há»‡ thá»‘ng. NhÆ°ng thá»‰nh thoáº£ng chÃºng tÃ´i láº¡i cáº§n thÃªm nhá»¯ng hÃ m má»›i, vÃ  vÃ¬ váº­y chÃºng tÃ´i cáº§n chá»n kiá»ƒu cáº¥u trÃºc. CÃ¡c nhÃ  phÃ¡t triá»ƒn pháº§n má»m giá»i luÃ´n biáº¿t cÃ¡ch tiáº¿p cáº­n tá»‘t nháº¥t trong nhá»¯ng trÆ°á»ng há»£p nÃ y.</p>
<h2 id="tham-kháº£o">Tham kháº£o</h2>
<p><em>Refactoring: Improving the Design of Existing Code</em>, Martin Fowler et al., Addison-Wesley, 1999.</p>

</div>
</div>
<div class="flex flex-row justify-around my-2">
  <h3 class="mb-1 mt-1 text-left mr-4">
    
    <a
      href="/blog/clean-code-chapter-7/"
      title="[Book] Clean Code - Chapter 7"
    >
      <i class="nav-menu fas fa-chevron-circle-left"></i>
    </a>
    
  </h3>
  <h3 class="mb-1 mt-1 text-left ml-4">
    
    <a
      href="/blog/clean-code-chapter-5/"
      title="[Book] Clean Code - Chapter 5"
    >
      <i class="nav-menu fas fa-chevron-circle-right"></i>
    </a>
    
  </h3>
</div>

<!DOCTYPE html>
<html lang="en">
<head>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>

    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>

    
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "\\[", right: "\\]", display: true },
                { left: "\\begin{align}", right: "\\end{align}", display: true },
                { left: "\\begin{bmatrix}", right: "\\end{bmatrix}", display: true },
            ],
        });
    });
    </script>

    
</head>
<body>
    
</body>
</html>

    </main>
    
    <footer class="text-sm text-center border-t border-gray-300 dark:border-gray-700  py-6 ">
  <figure>
    <embed src="https://wakatime.com/share/@phatcvo/ef5cf505-baef-4bdb-968e-ee58794efd63.svg" style="width: auto; height: auto;"></embed>
  </figure>
  <p class="markdownify">Â© 2024 Â· phatcvo</p>
  <p style="font-size:0px;">
    <i>
      <a href="https://github.com/darshanbaral/aafu">
        aafu
      </a>
    </i>
    by
    <a href="https://www.darshanbaral.com/">
      darshan
    </a>
  </p>
</footer>

    
  </body>
</html>
